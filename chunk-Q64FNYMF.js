import{a as J}from"./chunk-CTCXOKQJ.js";import{e as H,h as W,p as q,u as z}from"./chunk-6GDXSBLF.js";import{a as K}from"./chunk-OSRW7R4H.js";import{G as V,g as R,j as M,l as Y,m as B,s as U,u as N,v as G}from"./chunk-7O2Q7PLR.js";import{$b as c,Bb as y,Bc as D,Cb as j,Da as s,Ea as u,Eb as k,Fa as w,Fb as T,Ga as A,Gb as r,Hb as o,Ib as g,Kb as h,Pb as p,Rb as d,ac as C,bc as v,cb as l,gc as E,kc as F,lc as O,mb as b,na as _,sb as P,ta as I,v as $,wb as m,yb as S}from"./chunk-2BSAHQW3.js";function f(n){if(!n)return"";if(n.toLowerCase().endsWith(".webp"))return n;try{if(n.includes("dummyjson.com/image"))return`${n}?format=webp`;let e=new URL(n);return e.searchParams.set("format","webp"),e.toString()}catch{return n}}var ee=(n,e)=>e.id;function te(n,e){if(n&1){let t=h();r(0,"app-product-card",4),p("click",function(){let i=s(t).$implicit,x=d();return u(x.onProductSelect(i))}),o()}if(n&2){let t=e.$implicit;m("product",t)}}var L=class n{constructor(){this.category=null;this.store=_(V);this.router=_(N);this.viewportScroller=_(Y);this.relatedProducts$=this.store.select(q).pipe($(e=>{let t=this.category?e.filter(a=>a.category===this.category):e;return this.excludeId!==void 0&&(t=t.filter(a=>a.id!==this.excludeId)),this.getRandomProducts(t,4)}))}ngOnInit(){this.store.dispatch(H())}getRandomProducts(e,t){return[...e].sort(()=>Math.random()-.5).slice(0,t)}onProductSelect(e){this.router.navigate(["/product",e.id]).then(()=>{setTimeout(()=>{this.viewportScroller.scrollToPosition([0,0])})})}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=I({type:n,selectors:[["app-you-may-also-like"]],inputs:{category:"category",excludeId:"excludeId"},standalone:!0,features:[E],decls:7,vars:2,consts:[[1,"mt-12"],[1,"text-2xl","font-bold","mb-6"],[1,"grid","grid-cols-1","sm:grid-cols-2","md:grid-cols-3","lg:grid-cols-4","gap-4"],[3,"product"],[3,"click","product"]],template:function(t,a){t&1&&(r(0,"section",0)(1,"h2",1),c(2,"You May Also Like"),o(),r(3,"div",2),k(4,te,1,1,"app-product-card",3,ee),F(6,"async"),o()()),t&2&&(l(4),T(O(6,0,a.relatedProducts$)))},dependencies:[M,R,J],encapsulation:2})}};function ie(n,e){n&1&&(r(0,"div",0),g(1,"div",2),o())}function ne(n,e){n&1&&(r(0,"div",1)(1,"p",3),c(2,"Product not found"),o(),r(3,"a",4),c(4,"Return to Home"),o()())}function oe(n,e){if(n&1&&(r(0,"div",11),c(1),o()),n&2){let t=d(2);l(),v(" -",t.product().discountPercentage.toFixed(0),"% ")}}function re(n,e){if(n&1){let t=h();r(0,"button",34),p("click",function(){s(t);let i=d(2);return u(i.previousImage())}),w(),r(1,"svg",35),g(2,"path",36),o()(),A(),r(3,"button",37),p("click",function(){s(t);let i=d(2);return u(i.nextImage())}),w(),r(4,"svg",35),g(5,"path",38),o()()}}function ae(n,e){if(n&1){let t=h();r(0,"button",13),p("click",function(){let i=s(t).$implicit,x=d(2);return u(x.selectImage(i))}),g(1,"img",14),o()}if(n&2){let t=e.$implicit,a=e.$index,i=d(2);S("ring-2",i.selectedImage()===t)("ring-blue-500",i.selectedImage()===t),l(),m("ngSrc",t)("alt","Image "+a+" of "+i.product().title)}}function le(n,e){if(n&1&&(r(0,"span",22),c(1),o()),n&2){let t=d(2);l(),v(" $",t.getOriginalPrice()," ")}}function ce(n,e){if(n&1){let t=h();r(0,"div",5)(1,"div",6)(2,"div",7)(3,"div",8)(4,"div",9)(5,"img",10),p("load",function(){s(t);let i=d();return u(i.onImageLoad())}),o(),P(6,oe,2,1,"div",11)(7,re,6,0),o()(),r(8,"div",12)(9,"button",13),p("click",function(){s(t);let i=d();return u(i.selectImage(i.product().thumbnail))}),g(10,"img",14),o(),k(11,ae,2,6,"button",15,j),o()(),r(13,"div",16)(14,"h1",17),c(15),o(),r(16,"p",18),c(17),o(),r(18,"div",19)(19,"div",20)(20,"span",21),c(21),o(),P(22,le,2,1,"span",22),o(),r(23,"div",23)(24,"span",24),c(25),o(),w(),r(26,"svg",25),g(27,"path",26),o()()(),A(),r(28,"div",27)(29,"div",28)(30,"span",18),c(31,"Category"),o(),r(32,"span",29),c(33),o()(),r(34,"div",28)(35,"span",18),c(36,"Brand"),o(),r(37,"span",29),c(38),o()()(),r(39,"div",30)(40,"button",31),p("click",function(){s(t);let i=d();return u(i.addToCart())}),c(41),o()()()()(),r(42,"div",32),g(43,"app-you-may-also-like",33),o()}if(n&2){let t,a,i=d();l(5),S("opacity-0",i.isImageTransitioning()),m("ngSrc",i.getSelectedImageUrl())("alt",i.product().title),l(),y(i.product().discountPercentage>0?6:-1),l(),y(i.hasMultipleImages()?7:-1),l(2),S("ring-2",!i.selectedImage()||i.selectedImage()===i.product().thumbnail)("ring-blue-500",!i.selectedImage()||i.selectedImage()===i.product().thumbnail),l(),m("ngSrc",i.thumbnail())("alt","Thumbnail of "+i.product().title),l(),T(i.webpImages()),l(4),C(i.product().title),l(2),C(i.product().description),l(4),v("$",i.product().price,""),l(),y(i.product().discountPercentage>0?22:-1),l(3),v("",i.product().rating," "),l(8),C(i.product().category),l(5),C(i.product().brand),l(2),m("disabled",i.product().stock===0),l(),v(" ",i.product().stock===0?"Out of Stock":"Add to Cart"," "),l(2),m("category",((t=i.product())==null?null:t.category)||null)("excludeId",(a=i.product())==null?null:a.id)}}var Q=class n{constructor(){this.route=_(U);this.store=_(V);this.product=b(null);this.isLoading=b(!0);this.selectedImage=b(null);this.imageTransitioning=b(!1);this.thumbnail=D(()=>this.product()?.thumbnail?f(this.product().thumbnail):"");this.webpImages=D(()=>{let e=this.product();return!e?.images||!Array.isArray(e.images)?[]:e.images.map(t=>f(t))});this.allImages=D(()=>{let e=this.product();return e?.thumbnail?[e.thumbnail,...e.images||[]]:[]});this.route.paramMap.subscribe(e=>{let t=e.get("id");t&&(this.isLoading.set(!0),this.selectedImage.set(null),this.store.dispatch(W({id:parseInt(t,10)})),this.store.select(z(parseInt(t,10))).subscribe(a=>{this.product.set(a||null),this.isLoading.set(!1)}))})}getOriginalPrice(){let e=this.product();return e?(e.price/(1-e.discountPercentage/100)).toFixed(2):"0.00"}getSelectedImageUrl(){let e=this.product();if(!e?.thumbnail)return"";let t=this.selectedImage();return t?f(t):f(e.thumbnail)}selectImage(e){e&&(this.imageTransitioning.set(!0),this.selectedImage.set(f(e)))}addToCart(){let e=this.product();!e||e.stock===0||this.store.dispatch(K({product:e}))}hasMultipleImages(){return this.allImages().length>1}isImageTransitioning(){return this.imageTransitioning()}onImageLoad(){this.imageTransitioning.set(!1)}nextImage(){let e=this.allImages();if(e.length<=1)return;let t=this.selectedImage(),a=t?e.findIndex(x=>f(x)===t):0;this.imageTransitioning.set(!0);let i=(a+1)%e.length;this.selectImage(e[i])}previousImage(){let e=this.allImages();if(e.length<=1)return;let t=this.selectedImage(),a=t?e.findIndex(x=>f(x)===t):0;this.imageTransitioning.set(!0);let i=(a-1+e.length)%e.length;this.selectImage(e[i])}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=I({type:n,selectors:[["app-product-detail"]],standalone:!0,features:[E],decls:3,vars:1,consts:[[1,"flex","items-center","justify-center","min-h-[400px]"],[1,"flex","flex-col","items-center","justify-center","min-h-[400px]","space-y-4"],[1,"animate-spin","rounded-full","h-12","w-12","border-t-2","border-b-2","border-blue-500"],[1,"text-lg","text-gray-600"],["routerLink","/",1,"text-blue-500","hover:underline"],[1,"bg-white","rounded-lg","shadow-sm","p-6"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-8"],[1,"flex","flex-row-reverse","gap-6"],[1,"flex-1"],[1,"relative","w-full","h-[600px]","overflow-hidden","bg-gray-100","rounded-lg","group"],["width","800","height","600","priority","",1,"w-full","h-full","object-contain",3,"load","ngSrc","alt"],[1,"absolute","top-4","right-4","bg-red-500","text-white","text-sm","font-bold","px-3","py-1.5","rounded"],[1,"flex","flex-col","gap-3","w-24"],["type","button",1,"relative","aspect-square","overflow-hidden","rounded-lg","bg-gray-100","hover:ring-2","hover:ring-blue-500","transition-all",3,"click"],["width","96","height","96",1,"w-full","h-full","object-cover",3,"ngSrc","alt"],["type","button",1,"relative","aspect-square","overflow-hidden","rounded-lg","bg-gray-100","hover:ring-2","hover:ring-blue-500","transition-all",3,"ring-2","ring-blue-500"],[1,"space-y-6"],[1,"text-2xl","font-bold","text-gray-900"],[1,"text-gray-600"],[1,"flex","items-center","gap-4"],[1,"flex","items-center","gap-2"],[1,"text-3xl","font-bold","text-gray-900"],[1,"text-lg","text-gray-500","line-through"],[1,"flex","items-center","text-yellow-500"],[1,"text-lg","font-medium","mr-1"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","currentColor",1,"w-6","h-6"],["fill-rule","evenodd","d","M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.007 5.404.433c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.433 2.082-5.006z","clip-rule","evenodd"],[1,"space-y-2"],[1,"flex","items-center","justify-between","text-sm"],[1,"font-medium","text-gray-900"],[1,"pt-4"],["type","button",1,"w-full","bg-blue-900","text-white","px-6","py-3","rounded-lg","font-medium","hover:bg-blue-800","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:ring-offset-2","transition-colors","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[1,"mt-12","bg-white","rounded-lg","shadow-sm","p-6"],[3,"category","excludeId"],["type","button","aria-label","Previous image",1,"absolute","left-4","top-1/2","-translate-y-1/2","bg-black/50","hover:bg-black/70","text-white","p-3","rounded-full","opacity-0","group-hover:opacity-100","transition-opacity","duration-200","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"click"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","2","stroke","currentColor",1,"w-6","h-6"],["stroke-linecap","round","stroke-linejoin","round","d","M15.75 19.5L8.25 12l7.5-7.5"],["type","button","aria-label","Next image",1,"absolute","right-4","top-1/2","-translate-y-1/2","bg-black/50","hover:bg-black/70","text-white","p-3","rounded-full","opacity-0","group-hover:opacity-100","transition-opacity","duration-200","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"click"],["stroke-linecap","round","stroke-linejoin","round","d","M8.25 4.5l7.5 7.5-7.5 7.5"]],template:function(t,a){t&1&&P(0,ie,2,0,"div",0)(1,ne,5,0,"div",1)(2,ce,44,23),t&2&&y(a.isLoading()?0:a.product()?2:1)},dependencies:[M,B,G,L],encapsulation:2})}};export{Q as ProductDetailComponent};
