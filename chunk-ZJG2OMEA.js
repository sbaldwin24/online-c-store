import{a as ce}from"./chunk-3PHBWOYS.js";import{b as q,d as Y,e as X,f as Q,g as K,h as pe}from"./chunk-6TJ5Y34S.js";import"./chunk-2LBAACNN.js";import{b as J,c as $,e as W,f as Z,i as ee,j as te,k as ie,l as oe,n as ne,q as A,r as E,t as b,v as I}from"./chunk-XOAENC4N.js";import{b as re,c as ae,d as le,g as se,h as me,i as de}from"./chunk-OSRW7R4H.js";import{G as P,g as L,j as F,u as G,v as U}from"./chunk-7O2Q7PLR.js";import{$b as n,Bb as V,Bc as j,Da as u,Ea as f,Eb as H,Fa as g,Fb as N,G as D,Ga as y,Gb as t,Hb as i,Ib as d,Kb as C,Pb as v,Rb as m,ac as z,bc as c,cb as a,gc as M,k as B,kc as w,lc as k,na as p,r as R,sb as _,ta as T,vb as S,wb as x}from"./chunk-2BSAHQW3.js";function be(r,o){if(r&1){let e=C();t(0,"div",3)(1,"p",4),n(2,"Available Offer!"),i(),t(3,"p"),n(4," Use code "),t(5,"span",5),n(6,"MERRY-"),t(7,"strong",6),n(8,"CHRIST"),i(),n(9,"MAS"),i(),n(10," to get 10% off your order. "),i()(),t(11,"form",7),v("ngSubmit",function(){u(e);let l=m();return f(l.applyPromo())}),d(12,"input",8),t(13,"button",9),n(14," Apply "),i()()}if(r&2){let e=m();a(11),x("formGroup",e.promoForm),a(2),x("disabled",!e.promoForm.valid)}}function ge(r,o){if(r&1){let e=C();t(0,"div",2)(1,"div")(2,"p",10),n(3),i(),t(4,"p",11),n(5),i()(),t(6,"button",12),v("click",function(){u(e);let l=m();return f(l.removePromo())}),n(7," Remove "),i()()}if(r&2){let e=m();a(3),c(" Code applied: ",e.appliedPromoCode()," "),a(2),c(" Discount: $",e.discount().toFixed(2)," ")}}var ue={CHRISTMAS:"MERRY-CHRISTMAS"},Ce={[ue.CHRISTMAS]:.1},he=3e3,O=class r{constructor(){this.store=p(P);this.fb=p(oe);this.snackBar=p(pe);this.promoForm=this.fb.group({promoCode:["",[$.required,$.minLength(3)]]});this.appliedPromoCode=this.store.selectSignal(X);this.subtotal=this.store.selectSignal(Y);this.discount=this.store.selectSignal(Q);this.isValidPromoCode=j(()=>{let o=this.promoForm.get("promoCode")?.value?.toUpperCase()??"";return Object.values(ue).includes(o)})}showSnackBar(o,e){let s={duration:he,panelClass:[e?"success-snackbar":"error-snackbar"]};this.snackBar.open(o,"Close",s)}applyPromo(){if(this.promoForm.valid){let o=this.promoForm.get("promoCode")?.value?.toUpperCase()??"";if(this.isValidPromoCode()){let e=Ce[o],s=this.subtotal()*e;this.store.dispatch(se({code:o})),this.store.dispatch(de({discount:s})),this.showSnackBar("Promo code applied successfully!",!0)}else this.showSnackBar("Invalid promo code",!1);this.promoForm.reset({promoCode:""})}}removePromo(){this.store.dispatch(me())}static{this.\u0275fac=function(e){return new(e||r)}}static{this.\u0275cmp=T({type:r,selectors:[["app-promo"]],standalone:!0,features:[M],decls:5,vars:1,consts:[[1,"bg-white","p-4","rounded-lg","border","border-gray-200"],[1,"text-lg","font-semibold","mb-2"],[1,"flex","items-center","justify-between","bg-green-50","p-3","rounded-lg"],[1,"bg-blue-50","border-l-4","border-blue-500","text-blue-700","p-3","mb-4","text-sm"],[1,"font-medium"],[1,"font-bold"],[1,"text-xl","text-red-500"],[1,"flex","gap-2",3,"ngSubmit","formGroup"],["type","text","formControlName","promoCode","placeholder","Enter promo code",1,"flex-1","px-3","py-2","border","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-blue-500"],["type","submit",1,"px-4","py-2","bg-blue-600","text-white","rounded-lg","hover:bg-blue-700","disabled:opacity-50","disabled:cursor-not-allowed",3,"disabled"],[1,"text-green-700","font-medium"],[1,"text-sm","text-green-600"],["type","button",1,"text-red-600","hover:text-red-700",3,"click"]],template:function(e,s){e&1&&(t(0,"div",0)(1,"h3",1),n(2,"Promo Code"),i(),_(3,be,15,2)(4,ge,8,2,"div",2),i()),e&2&&(a(3),V(s.appliedPromoCode()?4:3))},dependencies:[F,ne,ee,J,W,Z,te,ie],encapsulation:2})}};var ye=(r,o)=>o.id;function _e(r,o){r&1&&(t(0,"div",2)(1,"div",3),g(),t(2,"svg",4),d(3,"path",5),i()(),y(),t(4,"p",6),n(5,"Your cart is empty"),i(),t(6,"p",7),n(7," Looks like you haven't added any items yet "),i(),t(8,"a",8),n(9," Continue Shopping "),i()()),r&2&&x("@fadeSlide",void 0)}function Se(r,o){if(r&1){let e=C();t(0,"li",11)(1,"div",23)(2,"h3",24),n(3),i(),t(4,"p",25),n(5),i()(),t(6,"div",26)(7,"div",27)(8,"button",28),v("click",function(){let l=u(e).$implicit,h=m(2);return f(h.decrement(l.id))}),g(),t(9,"svg",29),d(10,"path",30),i()(),y(),t(11,"span",31),n(12),i(),t(13,"button",28),v("click",function(){let l=u(e).$implicit,h=m(2);return f(h.increment(l.id))}),g(),t(14,"svg",29),d(15,"path",32),i()()(),y(),t(16,"div",33)(17,"span",24),n(18),i()(),t(19,"button",34),v("click",function(){let l=u(e).$implicit,h=m(2);return f(h.remove(l.id))}),g(),t(20,"svg",21),d(21,"path",35),i()()()()}if(r&2){let e=o.$implicit;x("@itemAnimation",void 0),a(3),z(e.name),a(2),c("$",e.price,""),a(3),S("aria-label","Decrease quantity of "+e.name),a(3),S("aria-label","Current quantity"),a(),c(" ",e.quantity," "),a(),S("aria-label","Increase quantity of "+e.name),a(5),c(" $",(e.price*e.quantity).toFixed(2)," "),a(),S("aria-label","Remove "+e.name+" from cart")}}function we(r,o){if(r&1){let e=C();t(0,"div",9)(1,"ul",10),H(2,Se,22,9,"li",11,ye),w(4,"async"),i()(),t(5,"div",12),d(6,"app-promo",13),t(7,"div",14)(8,"div",15)(9,"span"),n(10,"Subtotal"),i(),t(11,"span"),n(12),w(13,"async"),i()(),t(14,"div",16)(15,"div",17)(16,"span",18),n(17,"Total"),i(),t(18,"span",19),n(19),w(20,"async"),i()()(),t(21,"button",20),v("click",function(){u(e);let l=m();return f(l.checkout())}),g(),t(22,"svg",21),d(23,"path",22),i(),y(),t(24,"span"),n(25,"Proceed to Checkout"),i()()()()}if(r&2){let e,s,l=m();x("@fadeSlide",void 0),a(2),N(k(4,4,l.cartItems$)),a(3),x("@fadeSlide",void 0),a(7),c("$",(e=k(13,6,l.cartTotal$))==null?null:e.toFixed(2),""),a(7),c(" $",(s=k(20,8,l.cartTotal$))==null?null:s.toFixed(2)," ")}}var fe=class r{constructor(){this.store=p(P);this.cartService=p(ce);this.router=p(G);this.destroy$=new B;this.initialized=!1;this.cartItems$=this.store.select(q).pipe(D(()=>R([])));this.cartTotal$=this.store.select(K).pipe(D(()=>R(0)))}ngOnInit(){if(!this.initialized)try{this.cartService.loadCart(),this.initialized=!0}catch(o){console.error("Failed to load cart:",o)}}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.destroy$.unsubscribe()}increment(o){try{this.store?.dispatch&&this.store.dispatch(ae({id:o}))}catch(e){console.error("Failed to increment item:",e)}}decrement(o){try{this.store?.dispatch&&this.store.dispatch(le({id:o}))}catch(e){console.error("Failed to decrement item:",e)}}remove(o){try{this.store?.dispatch&&this.store.dispatch(re({id:o}))}catch(e){console.error("Failed to remove item:",e)}}checkout(){try{this.router?.navigate&&this.router.navigate(["/checkout"]).catch(o=>{console.error("Navigation failed:",o)})}catch(o){console.error("Failed to navigate to checkout:",o)}}static{this.\u0275fac=function(e){return new(e||r)}}static{this.\u0275cmp=T({type:r,selectors:[["app-cart"]],standalone:!0,features:[M],decls:6,vars:3,consts:[[1,"container","mx-auto","px-4","mt-8","max-w-4xl"],[1,"text-3xl","font-bold","mb-6","text-gray-800"],[1,"text-center","py-12","bg-white","rounded-lg","shadow-sm"],[1,"mb-4"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-16","w-16","mx-auto","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"],[1,"text-gray-700","text-lg","mb-2"],[1,"text-gray-500","mb-6"],["routerLink","/",1,"inline-flex","items-center","justify-center","px-6","py-3","border","border-transparent","text-base","font-medium","rounded-md","text-white","bg-blue-600","hover:bg-blue-700","transition-colors","duration-200"],[1,"bg-white","rounded-lg","shadow-sm","overflow-hidden"],[1,"divide-y","divide-gray-200"],[1,"flex","flex-col","sm:flex-row","justify-between","items-center","p-4","gap-4"],[1,"mt-8","bg-white","rounded-lg","shadow-sm","p-6"],[1,"mb-6"],[1,"space-y-4"],[1,"flex","justify-between","items-center","text-gray-600"],[1,"border-t","pt-4"],[1,"flex","justify-between","items-center"],[1,"text-lg","font-medium","text-gray-900"],[1,"text-2xl","font-bold","text-gray-900"],["type","button",1,"w-full","bg-blue-900","hover:bg-blue-700","text-white","font-medium","py-3","px-6","rounded-lg","transition-colors","duration-200","flex","items-center","justify-center","space-x-2","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:ring-offset-2",3,"click"],["aria-hidden","true","xmlns","http://www.w3.org/2000/svg","viewBox","0 0 20 20","fill","currentColor",1,"h-5","w-5"],["fill-rule","evenodd","d","M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z","clip-rule","evenodd"],[1,"flex-1"],[1,"font-medium","text-gray-900"],[1,"text-gray-500"],[1,"flex","items-center","gap-4"],[1,"flex","items-center","border","rounded-lg","overflow-hidden","shadow-sm"],["type","button",1,"px-3","py-2","hover:bg-gray-100","transition-colors","focus:outline-none","focus:ring-2","focus:ring-inset","focus:ring-blue-500",3,"click"],["aria-hidden","true","xmlns","http://www.w3.org/2000/svg","viewBox","0 0 20 20","fill","currentColor",1,"h-4","w-4","text-gray-600"],["fill-rule","evenodd","d","M3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z","clip-rule","evenodd"],[1,"px-4","py-2","min-w-[3rem]","text-center","text-gray-900"],["fill-rule","evenodd","d","M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z","clip-rule","evenodd"],[1,"w-24","text-right"],["type","button",1,"text-gray-400","hover:text-red-600","transition-colors","p-2","rounded-full","hover:bg-gray-100","focus:outline-none","focus:ring-2","focus:ring-red-500",3,"click"],["fill-rule","evenodd","d","M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z","clip-rule","evenodd"]],template:function(e,s){if(e&1&&(t(0,"section",0)(1,"h2",1),n(2,"Shopping Cart"),i(),_(3,_e,10,1,"div",2),w(4,"async"),_(5,we,26,10),i()),e&2){let l;a(3),V(((l=k(4,1,s.cartItems$))==null?null:l.length)===0?3:5)}},dependencies:[L,F,O,U],encapsulation:2,data:{animation:[A("fadeSlide",[I(":enter",[b({opacity:0,transform:"translateY(20px)"}),E("300ms ease-out",b({opacity:1,transform:"translateY(0)"}))]),I(":leave",[E("300ms ease-in",b({opacity:0,transform:"translateY(20px)"}))])]),A("itemAnimation",[I(":enter",[b({opacity:0,transform:"translateX(-20px)"}),E("200ms ease-out",b({opacity:1,transform:"translateX(0)"}))]),I(":leave",[E("200ms ease-in",b({opacity:0,transform:"translateX(20px)"}))])])]}})}};export{fe as CartComponent};
